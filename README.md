# タクシードライバーサポート PWA

タクシー乗車記録を管理するプログレッシブウェブアプリ（PWA）です。

## 🚀 GitHub Pagesでのデプロイ方法

### 1. GitHubリポジトリを作成

1. [GitHub](https://github.com) にログイン
2. 右上の「+」→「New repository」をクリック
3. リポジトリ名を入力（例：`taxi-driver-app`）
4. 「Public」を選択
5. 「Create repository」をクリック

### 2. ファイルをアップロード

#### 方法A：Web UIでアップロード（推奨）

1. 作成したリポジトリのページで「uploading an existing file」をクリック
2. 以下のファイルをすべてドラッグ&ドロップ：
   ```
   index.html
   manifest.json
   service-worker.js
   icon-192.png
   icon-512.png
   icon-152.png
   .nojekyll
   README.md
   ```
3. Commit messageに「Initial commit」と入力
4. 「Commit changes」をクリック

#### 方法B：コマンドライン

```bash
# 1. ファイルをダウンロードしたフォルダに移動
cd /path/to/your/folder

# 2. Gitの初期化
git init

# 3. すべてのファイルを追加
git add .

# 4. コミット
git commit -m "Initial commit"

# 5. ブランチ名をmainに変更
git branch -M main

# 6. リモートリポジトリを追加（URLは自分のものに変更）
git remote add origin https://github.com/YOUR-USERNAME/taxi-driver-app.git

# 7. プッシュ
git push -u origin main
```

### 3. GitHub Pagesを有効化

1. リポジトリの「Settings」タブをクリック
2. 左サイドバーの「Pages」をクリック
3. 「Source」で「Deploy from a branch」を選択
4. 「Branch」で「main」と「/ (root)」を選択
5. 「Save」をクリック

### 4. アクセス

数分後（通常1-2分）、以下のURLでアクセスできます：
```
https://YOUR-USERNAME.github.io/taxi-driver-app/
```

✅ HTTPSで配信されるため、Service Workerが正常に動作します
✅ 完全なオフライン機能が使えます
✅ PWAとして完璧に動作します

## 📱 iOSのSafariでホーム画面に追加する方法

### 手順

1. **SafariでGitHub PagesのURLを開く**
   - `https://YOUR-USERNAME.github.io/taxi-driver-app/`
   
2. **共有ボタンをタップ**
   - 画面下部の共有ボタン（□に↑のアイコン）をタップ
   
3. **「ホーム画面に追加」を選択**
   - メニューから「ホーム画面に追加」をタップ
   
4. **アプリ名を確認して「追加」**
   - アプリ名は「タクシー記録」として表示されます
   - 右上の「追加」をタップ

5. **完了！**
   - ホーム画面にアイコンが追加されます
   - 通常のアプリと同じように使えます

## ✨ 主な機能

### 📝 乗車記録の管理
- 乗車地・降車地の記録
- 乗車時刻・降車時刻（時間ピッカー）
- 所要時間の自動計算
- Goアプリ / 手挙げの区別
- 記録の編集・削除機能

### 🔍 検索機能
- **時間検索**: 指定時刻の前後15分（±15分）の記録を検索
- **🆕 日付検索**: 特定の日付の記録を一覧表示

### 🔄 バックアップ機能（iOS対応）
- **💾 上書き保存**: 同じファイル名で保存（クリックするだけ）
- **📥 別名保存**: 新しいファイル名で保存
- **📂 読込**: 保存したファイルを読み込み
- iOS Safari、全ブラウザ対応

### 🤖 AI助言機能
- **🆕 Google Gemini API連携**: 現在の時刻と過去のデータから、おすすめエリアをアドバイス
- 無料枠利用可能（APIキーの取得が必要）
- [Google AI Studio](https://makersuite.google.com/app/apikey) でAPIキーを取得
- 設定ボタン（⚙️）からAPIキーを入力

### 📊 統計表示
- 総乗車数
- Goアプリ / 手挙げの内訳

### 💾 データ管理
- LocalStorageに自動保存
- JSONファイルでエクスポート/インポート
- データのバックアップが可能

### 📴 オフライン対応
- インターネット接続なしでも動作
- データはデバイスに保存

## 📂 ファイル構成

```
├── index.html          # メインアプリケーション
├── app.js              # アプリケーションロジック
├── manifest.json       # PWA設定ファイル
├── service-worker.js   # オフライン対応
├── icon-192.png        # アプリアイコン（192x192）
├── icon-512.png        # アプリアイコン（512x512）
├── icon-152.png        # iOS用アイコン（152x152）
├── .nojekyll           # Jekyll無効化ファイル
├── README.md           # このファイル
└── DEPLOY.md           # デプロイ手順書
```

## 🚀 使い方

### 新しい記録を追加

1. 「新しい乗車記録を追加」ボタンをタップ
2. 乗車地、降車地を入力
3. 日付を選択（任意、デフォルトは今日）
4. 乗車時刻と降車時刻を選択
5. 取得方法（Goアプリ / 手挙げ）を選択
6. 「登録」ボタンをタップ

### 記録を検索

#### 時間検索
1. 「時間検索」タブをタップ
2. 検索したい時刻を選択
3. その時刻の前後15分の記録が表示されます

#### 日付検索
1. 「日付検索」タブをタップ
2. 検索したい日付を選択
3. その日付の記録が表示されます

### 記録を編集・削除

- 各記録の右側にある編集ボタン（✏️）で編集
- ゴミ箱ボタン（🗑️）で削除

### データのバックアップ

#### 💾 上書き保存（おすすめ）

1. 右上の「💾 上書き保存」ボタンをタップ
2. 同じファイル名で自動ダウンロード（初回はファイル名を自動生成）
3. **次回以降も同じボタンで同じファイル名に上書き保存**

**iOS Safari対応**: すべてのブラウザで動作します！

#### 📥 別名保存

1. 右上の「📥 別名保存」ボタンで新しいファイル名で保存
2. 日付入りのファイル名が自動生成されます

#### 📂 読込

1. 「📂 読込」ボタンで保存したファイルを選択
2. データが復元されます

### AI助言機能の使い方

#### 初回設定

1. 右上の設定ボタン（⚙️）をタップ
2. [Google AI Studio](https://makersuite.google.com/app/apikey) でAPIキーを取得（無料）
3. APIキーを入力して「保存」

#### アドバイスを取得

1. 「AI助言」タブをタップ
2. 「🤖 今の時間帯のアドバイスを取得」ボタンをタップ
3. 現在の時刻と過去のデータから、おすすめエリアが表示されます

## 💡 Tips

- **💾 上書き保存を活用**: 「上書き保存」ボタンを使えば、毎回同じファイル名で保存されます。**iOSでも使えます！**

- **定期的にバックアップ**: データの入力・編集後は「上書き保存」ボタンをタップしましょう。すぐにバックアップが取れます。

- **AI助言を活用**: 過去のデータが蓄積されると、AIがより正確なアドバイスをしてくれます。時間帯ごとの傾向を分析し、どのエリアに行けば効率的か提案します。

- **時間検索の仕組み**: 指定した時刻の前後15分（±15分、合計30分幅）で検索されます。例：15時30分を検索 → 15時15分〜15時45分の記録を表示

- **データはデバイスに保存**: LocalStorageを使用しているため、ブラウザのデータを消去するとデータも消えます。定期的にバックアップを取ることをおすすめします。

- **複数デバイスでの使用**: JSONファイルでエクスポート/インポートすることで、複数のデバイス間でデータを共有できます。

- **オフラインでも使用可能**: 一度アプリを開けば、オフラインでも使用できます。

- **iOS Safari専用機能**: 初回起動時にホーム画面への追加を促すメッセージが表示されます。

## 🔧 技術仕様

- **言語**: Vanilla JavaScript（ライブラリ不要）
- **UI**: Tailwind CSS
- **データ保存**: LocalStorage + File Download API
- **AI**: Google Gemini API（gemini-1.5-flash）
- **PWA機能**: Service Worker, Web App Manifest
- **対応ブラウザ**: Chrome、Safari、Edge、Firefox（すべてのモダンブラウザ）

## 📝 注意事項

- このアプリはローカルで動作します（サーバー不要）
- データはデバイスに保存されます
- 定期的なバックアップをおすすめします
- iOS 11.3以降のSafariで動作確認済み
- **すべてのモダンブラウザで完全動作します**

### AI助言機能について

- **無料**: Google Gemini APIの無料枠を使用（月60リクエストまで無料）
- **APIキー**: [Google AI Studio](https://makersuite.google.com/app/apikey) で取得（Googleアカウント必要）
- **プライバシー**: データはGoogleのサーバーに送信されますが、学習には使用されません

### Service Workerについて

- **プレビュー環境**: Service Workerは動作しませんが、アプリの機能は問題なく使えます
- **ローカル環境/サーバー**: Service Workerが有効になり、オフライン機能が使えます
- エラーメッセージが出ても、アプリの動作には影響ありません

### 完全なオフライン機能を使う場合

1. すべてのファイルを同じフォルダに配置
2. ローカルサーバーで起動（例：`python -m http.server 8000`）
3. または、Webサーバーにアップロード

プレビュー環境やfile://プロトコルでは、Service Workerは動作しませんが、LocalStorageによるデータ保存は正常に機能します。

## 🆕 バージョン

Version 2.1.0 - 2024年10月

### 新機能
- 🔍 時間検索の改善（±15分検索）
- 📅 日付検索機能
- 💾 **上書き保存機能**（iOS対応・全ブラウザ対応）
- 🤖 AI助言機能（Google Gemini API連携）

---

作成日：2024年10月
